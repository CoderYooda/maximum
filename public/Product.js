(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{pgYA:function(t,s,e){"use strict";e.r(s);var r=e("zUJn"),o=e("QbiA"),i=e("8j27"),c={components:{ImagesUpload:o.a,EditorContent:r.b,EditorMenuBubble:r.c},name:"Product",data:function(){var t=this;return{images:[],keepInBounds:!0,category:{name:"Корневая директория",id:0},product:{name:"",price:0,article:"",action_price:0,isAction:!1,isPublished:!0,content:"",images:null,inStock:!0,title:null,description:null,slug:this.slug},editor:new r.a({extensions:[new i.a,new i.c,new i.e,new i.f,new i.g({levels:[1,2,3]}),new i.k,new i.l,new i.n,new i.o,new i.j,new i.b,new i.d,new i.i,new i.m,new i.p,new i.h],content:"",onInit:function(){},onUpdate:function(s){var e=s.getHTML;t.product.content=e()}})}},watch:{"product.slug":function(t){this.product.id||(this.product.slug=window.urlRusLat(t))},"product.name":function(t){this.product.id||(this.product.slug=window.urlRusLat(t),this.product.title=t)}},mounted:function(){var t=this;this.$store.dispatch("get_categories");var s=this.$store.getters.getProduct(this.$route.params.product_id);s?(this.product=s,this.editor.setContent(s.content),this.$refs.imgLoader.setImages(s.images[0]),this.category=this.$store.getters.getCategoryById(s.category_id)[0]):this.$store.dispatch("get_product",this.$route.params.product_id).then((function(e){s=e.data.product;var r=t.$route.query.category||s?s.category_id:0;t.editor.setContent(e.data.product.content),t.product=s,t.$refs.imgLoader.setImages(s.images[0]),t.setCategory(r)})).catch((function(){var s=t.$route.query.category;t.setCategory(s)}))},computed:{categories:function(){return this.$store.getters.categories}},methods:{setImages:function(t){this.product.images=t.images},change:function(t){var s=t.coordinates,e=t.canvas;console.log(s,e)},setCategory:function(t){var s=this,e=this.$store.getters.getCategoryById(t)[0];this.category=e,e||this.$store.dispatch("get_category",t).then((function(t){e=t.data.category,s.category=e}))},save:function(){var t=this;this.product.category_id=this.category?this.category.id:0;var s=this.product.id?"update_product":"store_product";this.$store.dispatch(s,this.product).then((function(){t.$router.push({name:"shop",params:{category_id:t.category?t.category.id:0}})}))}}},a=e("KHd+"),l=Object(a.a)(c,(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("div",{staticClass:"d-sm-flex align-items-center justify-content-between mg-b-20 mg-lg-b-30"},[e("div",[e("nav",{attrs:{"aria-label":"breadcrumb"}},[e("ol",{staticClass:"breadcrumb breadcrumb-style1 mg-b-10"},[e("router-link",{attrs:{to:"/site",custom:""},scopedSlots:t._u([{key:"default",fn:function(s){var r=s.href,o=(s.route,s.navigate);s.isActive,s.isExactActive;return[e("li",{staticClass:"breadcrumb-item"},[e("a",{attrs:{href:r},on:{click:o}},[t._v("Управление сайтом")])])]}}])}),t._v(" "),e("li",{staticClass:"breadcrumb-item active",attrs:{"aria-current":"page"}},[t._v(t._s(t.product.id?'Редактирование товара "'+t.product.name+'"':"Создание товара"))])],1)]),t._v(" "),e("h4",{staticClass:"mg-b-0 tx-spacing--1"},[t._v(t._s(t.product.id?'Редактирование товара "'+t.product.name+'"':"Новый товар"))])]),t._v(" "),e("div",{staticClass:"d-none d-md-block"},[e("button",{staticClass:"btn btn-sm pd-x-15 btn-white btn-uppercase",on:{click:t.save}},[t._v("Сохранить")])])]),t._v(" "),e("ImagesUpload",{ref:"imgLoader",attrs:{limit:"1"},on:{imagesChanged:t.setImages}}),t._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col-lg-2 mg-t-10 mg-lg-t-0 br"},[e("div",{staticClass:"form-group"},[e("div",{staticClass:"custom-control custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.product.isPublished,expression:"product.isPublished"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:"isPublished"},domProps:{checked:Array.isArray(t.product.isPublished)?t._i(t.product.isPublished,null)>-1:t.product.isPublished},on:{change:function(s){var e=t.product.isPublished,r=s.target,o=!!r.checked;if(Array.isArray(e)){var i=t._i(e,null);r.checked?i<0&&t.$set(t.product,"isPublished",e.concat([null])):i>-1&&t.$set(t.product,"isPublished",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.product,"isPublished",o)}}}),t._v(" "),e("label",{staticClass:"custom-control-label",attrs:{for:"isPublished"}},[t._v(" Опубликован")])])]),t._v(" "),e("div",{staticClass:"form-group"},[e("div",{staticClass:"custom-control custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.product.isAction,expression:"product.isAction"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:"isAction"},domProps:{checked:Array.isArray(t.product.isAction)?t._i(t.product.isAction,null)>-1:t.product.isAction},on:{change:function(s){var e=t.product.isAction,r=s.target,o=!!r.checked;if(Array.isArray(e)){var i=t._i(e,null);r.checked?i<0&&t.$set(t.product,"isAction",e.concat([null])):i>-1&&t.$set(t.product,"isAction",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.product,"isAction",o)}}}),t._v(" "),e("label",{staticClass:"custom-control-label",attrs:{for:"isAction"}},[t._v(" Акционный товар")])])]),t._v(" "),e("div",{staticClass:"form-group"},[e("div",{staticClass:"custom-control custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.product.inStock,expression:"product.inStock"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:"inStock"},domProps:{checked:Array.isArray(t.product.inStock)?t._i(t.product.inStock,null)>-1:t.product.inStock},on:{change:function(s){var e=t.product.inStock,r=s.target,o=!!r.checked;if(Array.isArray(e)){var i=t._i(e,null);r.checked?i<0&&t.$set(t.product,"inStock",e.concat([null])):i>-1&&t.$set(t.product,"inStock",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.product,"inStock",o)}}}),t._v(" "),e("label",{staticClass:"custom-control-label",attrs:{for:"inStock"}},[t._v(" Есть в наличии")])])]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"d-block"},[t._v("Цена")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.product.price,expression:"product.price"}],staticClass:"form-control",class:{"is-invalid":!!this.$store.getters.product_store_errors.price},attrs:{type:"number"},domProps:{value:t.product.price},on:{input:function(s){s.target.composing||t.$set(t.product,"price",s.target.value)}}}),t._v(" "),this.$store.getters.product_store_errors.price?e("div",{staticClass:"invalid-feedback"},[t._v(t._s(this.$store.getters.product_store_errors.price[0]))]):t._e()]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"d-block"},[t._v("Акционная цена")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.product.action_price,expression:"product.action_price"}],staticClass:"form-control",class:{"is-invalid":!!this.$store.getters.product_store_errors.action_price},attrs:{type:"number"},domProps:{value:t.product.action_price},on:{input:function(s){s.target.composing||t.$set(t.product,"action_price",s.target.value)}}}),t._v(" "),this.$store.getters.product_store_errors.action_price?e("div",{staticClass:"invalid-feedback"},[t._v(t._s(this.$store.getters.product_store_errors.action_price[0]))]):t._e()])]),t._v(" "),e("div",{staticClass:"col-lg-10"},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"d-block"},[t._v("Наименование товара")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.product.name,expression:"product.name"}],staticClass:"form-control",class:{"is-invalid":!!this.$store.getters.product_store_errors.name},attrs:{type:"text",placeholder:"Наименование товара"},domProps:{value:t.product.name},on:{input:function(s){s.target.composing||t.$set(t.product,"name",s.target.value)}}}),t._v(" "),this.$store.getters.product_store_errors.name?e("div",{staticClass:"invalid-feedback"},[t._v(t._s(this.$store.getters.product_store_errors.name[0]))]):t._e()]),t._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col-lg-6"},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"d-block"},[t._v("Артикул")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.product.article,expression:"product.article"}],staticClass:"form-control",class:{"is-invalid":!!this.$store.getters.product_store_errors.article},attrs:{type:"text",placeholder:"Артикул"},domProps:{value:t.product.article},on:{input:function(s){s.target.composing||t.$set(t.product,"article",s.target.value)}}}),t._v(" "),this.$store.getters.product_store_errors.article?e("div",{staticClass:"invalid-feedback"},[t._v(t._s(this.$store.getters.product_store_errors.article[0]))]):t._e()])]),t._v(" "),e("div",{staticClass:"col-lg-6"},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"d-block"},[t._v("Категория")]),t._v(" "),e("v-select",{class:{"is-invalid":!!this.$store.getters.product_store_errors.category_id},attrs:{label:"name",options:t.categories},model:{value:t.category,callback:function(s){t.category=s},expression:"category"}}),t._v(" "),this.$store.getters.product_store_errors.category_id?e("div",{staticClass:"invalid-feedback"},[t._v(t._s(this.$store.getters.product_store_errors.category_id[0]))]):t._e()],1)])]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"d-block"},[t._v("Описание товара")]),t._v(" "),e("editor-menu-bubble",{attrs:{editor:t.editor,"keep-in-bounds":t.keepInBounds},scopedSlots:t._u([{key:"default",fn:function(s){var r=s.commands,o=s.isActive,i=s.menu;return[e("div",{staticClass:"menububble",class:{"is-active":i.isActive},style:"left: "+i.left+"px; bottom: "+i.bottom+"px;"},[e("button",{staticClass:"menububble__button",class:{"is-active":o.bold()},on:{click:r.bold}},[e("img",{attrs:{src:"/images/icons/typo/bold-w.svg",alt:""}})]),t._v(" "),e("button",{staticClass:"menububble__button",class:{"is-active":o.italic()},on:{click:r.italic}},[e("img",{attrs:{src:"/images/icons/typo/italic-w.svg",alt:""}})]),t._v(" "),e("button",{staticClass:"menububble__button",class:{"is-active":o.code()},on:{click:r.code}},[e("img",{attrs:{src:"/images/icons/typo/code-w.svg",alt:""}})])])]}}])}),t._v(" "),e("editor-content",{attrs:{editor:t.editor}}),t._v(" "),this.$store.getters.product_store_errors.content?e("div",{staticClass:"invalid-feedback"},[t._v(t._s(this.$store.getters.product_store_errors.content[0]))]):t._e()],1)])]),t._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col-lg-12"},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"d-block"},[t._v("Тайтл ( Текст вкладки браузера )")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.product.title,expression:"product.title"}],staticClass:"form-control",class:{"is-invalid":!!this.$store.getters.product_store_errors.title},attrs:{type:"text",placeholder:"Тайтл"},domProps:{value:t.product.title},on:{input:function(s){s.target.composing||t.$set(t.product,"title",s.target.value)}}}),t._v(" "),this.$store.getters.product_store_errors.title?e("div",{staticClass:"invalid-feedback"},[t._v(t._s(this.$store.getters.product_store_errors.title[0]))]):t._e()])]),t._v(" "),e("div",{staticClass:"col-lg-12"},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"d-block"},[t._v("URL")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.product.slug,expression:"product.slug"}],staticClass:"form-control",class:{"is-invalid":!!this.$store.getters.product_store_errors.slug},attrs:{type:"text",placeholder:"URL"},domProps:{value:t.product.slug},on:{input:function(s){s.target.composing||t.$set(t.product,"slug",s.target.value)}}}),t._v(" "),this.$store.getters.product_store_errors.slug?e("div",{staticClass:"invalid-feedback"},[t._v(t._s(this.$store.getters.product_store_errors.slug[0]))]):t._e()])]),t._v(" "),e("div",{staticClass:"col-lg-12"},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"d-block"},[t._v("Описание страницы")]),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.product.description,expression:"product.description"}],staticClass:"form-control",class:{"is-invalid":!!this.$store.getters.product_store_errors.description},attrs:{rows:"4"},domProps:{value:t.product.description},on:{input:function(s){s.target.composing||t.$set(t.product,"description",s.target.value)}}}),t._v(" "),this.$store.getters.product_store_errors.description?e("div",{staticClass:"invalid-feedback"},[t._v(t._s(this.$store.getters.product_store_errors.description[0]))]):t._e()])])])],1)}),[],!1,null,"5f1afcd2",null);s.default=l.exports}}]);