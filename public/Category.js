(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{nppN:function(t,e,s){"use strict";s.r(e);var a=s("zUJn"),r=s("QbiA"),o=s("8j27"),i={components:{ImagesUpload:r.a,EditorContent:a.b,EditorMenuBubble:a.c},name:"Category",data:function(){var t=this;return{keepInBounds:!0,images:[],category:{name:"",content:"",images:null,parent:{name:"Корневая директория",id:0},title:null,description:null,slug:null},editor:new a.a({extensions:[new o.a,new o.c,new o.e,new o.f,new o.g({levels:[1,2,3]}),new o.k,new o.l,new o.n,new o.o,new o.j,new o.b,new o.d,new o.i,new o.m,new o.p,new o.h],content:"",onInit:function(){},onUpdate:function(e){var s=e.getHTML;t.category.content=s()}})}},watch:{"category.slug":function(t){this.category.slug=window.urlRusLat(t)},"category.name":function(t){this.category.slug=window.urlRusLat(t),this.category.title=t}},mounted:function(){var t=this;this.$store.dispatch("get_categories").then((function(){var e=t.$store.getters.getCategory(t.$route.params.category_id);e?(t.category=e,t.editor.setContent(t.category.content),t.$refs.imgLoader.setImages(e.images),t.category.category=t.$store.getters.getCategoryById(e.category_id)[0]):t.$store.dispatch("get_category",t.$route.params.category_id).then((function(s){t.category=s.data.category;var a=e?e.parent.id:0;t.editor.setContent(s.data.category.content),a||(a=t.$route.query.category?t.$route.query.category:0),t.$refs.imgLoader.setImages(t.category.images)})).catch((function(){var e=t.$route.query.category;console.log(e),t.setCategory(e)}))}))},computed:{categories:function(){return this.$store.getters.categories}},methods:{setImages:function(t){this.category.images=t.images},change:function(t){var e=t.coordinates,s=t.canvas;console.log(e,s)},setCategory:function(t){var e=this;if(0===t)this.category.parent={name:"Корневая директория",id:0};else{var s=this.$store.getters.getCategoryById(t)[0];console.log(s),this.category.parent=s,s||this.$store.dispatch("get_category",t).then((function(t){s=t.data.category,e.category.parent=s}))}},save:function(){var t=this;this.category.parent_id=this.parent?this.parent.parent.id:0;var e=this.category.id?"update_category":"store_category";this.$store.dispatch(e,this.category).then((function(){t.$router.push({name:"shop",params:{category_id:t.category?t.category.parent_id:0}})}))},initEditor:function(t){var e=this;this.editor=new a.a({extensions:[new o.a,new o.c,new o.e,new o.f,new o.g({levels:[1,2,3]}),new o.k,new o.l,new o.n,new o.o,new o.j,new o.b,new o.d,new o.i,new o.m,new o.p,new o.h],content:t,onInit:function(){e.init()},onUpdate:function(t){var s=t.getHTML;e.$props.chunk.text=s()}})}}},n=s("KHd+"),c=Object(n.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"d-sm-flex align-items-center justify-content-between mg-b-20 mg-lg-b-30"},[s("div",[s("nav",{attrs:{"aria-label":"breadcrumb"}},[s("ol",{staticClass:"breadcrumb breadcrumb-style1 mg-b-10"},[s("router-link",{attrs:{to:"/site",custom:""},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.href,r=(e.route,e.navigate);e.isActive,e.isExactActive;return[s("li",{staticClass:"breadcrumb-item"},[s("a",{attrs:{href:a},on:{click:r}},[t._v("Управление сайтом")])])]}}])}),t._v(" "),s("li",{staticClass:"breadcrumb-item active",attrs:{"aria-current":"page"}},[t._v("\n                        "+t._s(t.category.id?'Редактирование категории "'+t.category.name+'"':"Создание категории")+"\n                    ")])],1)]),t._v(" "),s("h4",{staticClass:"mg-b-0 tx-spacing--1"},[t._v(t._s(t.category.id?'Редактирование товара "'+t.category.name+'"':"Новая категория"))])]),t._v(" "),s("div",{staticClass:"d-none d-md-block"},[s("button",{staticClass:"btn btn-sm pd-x-15 btn-white btn-uppercase",on:{click:t.save}},[t._v("Сохранить")])])]),t._v(" "),s("ImagesUpload",{ref:"imgLoader",attrs:{limit:"1"},on:{imagesChanged:t.setImages}}),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-lg-6"},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"d-block"},[t._v("Наименование категории")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.category.name,expression:"category.name"}],staticClass:"form-control",class:{"is-invalid":!!this.$store.getters.category_store_errors.name},attrs:{type:"text",placeholder:"Наименование категории"},domProps:{value:t.category.name},on:{input:function(e){e.target.composing||t.$set(t.category,"name",e.target.value)}}}),t._v(" "),this.$store.getters.category_store_errors.name?s("div",{staticClass:"invalid-feedback"},[t._v(t._s(this.$store.getters.category_store_errors.name[0]))]):t._e()])]),t._v(" "),s("div",{staticClass:"col-lg-6"},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"d-block"},[t._v("В категории")]),t._v(" "),s("v-select",{class:{"is-invalid":!!this.$store.getters.category_store_errors.category_id},attrs:{label:"name",options:t.categories},model:{value:t.category.parent,callback:function(e){t.$set(t.category,"parent",e)},expression:"category.parent"}}),t._v(" "),this.$store.getters.category_store_errors.category_id?s("div",{staticClass:"invalid-feedback"},[t._v(t._s(this.$store.getters.category_store_errors.category_id[0]))]):t._e()],1)])]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"d-block"},[t._v("Описание категории")]),t._v(" "),s("editor-menu-bubble",{attrs:{editor:t.editor,"keep-in-bounds":t.keepInBounds},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.commands,r=e.isActive,o=e.menu;return[s("div",{staticClass:"menububble",class:{"is-active":o.isActive},style:"left: "+o.left+"px; bottom: "+o.bottom+"px;"},[s("button",{staticClass:"menububble__button",class:{"is-active":r.bold()},on:{click:a.bold}},[s("img",{attrs:{src:"/images/icons/typo/bold-w.svg",alt:""}})]),t._v(" "),s("button",{staticClass:"menububble__button",class:{"is-active":r.italic()},on:{click:a.italic}},[s("img",{attrs:{src:"/images/icons/typo/italic-w.svg",alt:""}})]),t._v(" "),s("button",{staticClass:"menububble__button",class:{"is-active":r.code()},on:{click:a.code}},[s("img",{attrs:{src:"/images/icons/typo/code-w.svg",alt:""}})])])]}}])}),t._v(" "),s("editor-content",{attrs:{editor:t.editor},model:{value:t.category.content,callback:function(e){t.$set(t.category,"content",e)},expression:"category.content"}}),t._v(" "),this.$store.getters.category_store_errors.content?s("div",{staticClass:"invalid-feedback"},[t._v(t._s(this.$store.getters.category_store_errors.content[0]))]):t._e()],1),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-lg-12"},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"d-block"},[t._v("URL")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.category.slug,expression:"category.slug"}],staticClass:"form-control",class:{"is-invalid":!!this.$store.getters.category_store_errors.slug},attrs:{type:"text",placeholder:"URL"},domProps:{value:t.category.slug},on:{input:function(e){e.target.composing||t.$set(t.category,"slug",e.target.value)}}}),t._v(" "),this.$store.getters.category_store_errors.slug?s("div",{staticClass:"invalid-feedback"},[t._v(t._s(this.$store.getters.category_store_errors.slug[0]))]):t._e()])]),t._v(" "),s("div",{staticClass:"col-lg-12"},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"d-block"},[t._v("Тайтл ( Title )")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.category.title,expression:"category.title"}],staticClass:"form-control",class:{"is-invalid":!!this.$store.getters.category_store_errors.title},attrs:{type:"text",placeholder:"Тайтл"},domProps:{value:t.category.title},on:{input:function(e){e.target.composing||t.$set(t.category,"title",e.target.value)}}}),t._v(" "),this.$store.getters.category_store_errors.title?s("div",{staticClass:"invalid-feedback"},[t._v(t._s(this.$store.getters.category_store_errors.title[0]))]):t._e()])]),t._v(" "),s("div",{staticClass:"col-lg-12"},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"d-block"},[t._v("Описание страницы ( Description )")]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.category.description,expression:"category.description"}],staticClass:"form-control",class:{"is-invalid":!!this.$store.getters.category_store_errors.description},attrs:{rows:"4"},domProps:{value:t.category.description},on:{input:function(e){e.target.composing||t.$set(t.category,"description",e.target.value)}}}),t._v(" "),this.$store.getters.category_store_errors.description?s("div",{staticClass:"invalid-feedback"},[t._v(t._s(this.$store.getters.category_store_errors.description[0]))]):t._e()])])])],1)}),[],!1,null,"e9ef6848",null);e.default=c.exports}}]);